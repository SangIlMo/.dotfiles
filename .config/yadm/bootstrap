#!/bin/bash
# ~/.config/yadm/bootstrap

echo "vim-plug 설치 중..."
if [ ! -f ~/.vim/autoload/plug.vim ]; then
  curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
       https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

# vim에서 플러그인을 자동으로 설치
vim +PlugInstall +qall

# Mise 설치
if ! command -v mise &> /dev/null; then
  echo "Installing Mise..."
  curl https://mise.run | sh
fi

# Zsh 환경에서 Mise 활성화 (zshrc에 포함되어 있음)
# echo 'eval "$(~/.local/bin/mise activate zsh)"' >> ~/.zshrc

# oh-my-zsh 설치 (미설치 된 경우만)
if [ ! -d "$HOME/.oh-my-zsh" ]; then
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --keep-zshrc
fi

# nvim 설치
if ! command -v nvim &> /dev/null; then
  echo "Installing Neovim..."
  brew install neovim
  curl https://mise.run | sh
  git clone https://github.com/folke/lazy.nvim.git ~/.local/share/nvim/lazy/lazy.nvim
fi

# D2Coding 폰트 설치 (Ghostty 한글 fallback)
if ! brew list --cask font-d2coding &>/dev/null; then
  echo "Installing D2Coding font..."
  brew install --cask font-d2coding
fi

# Ghostty 설치
if [ ! -d "/Applications/Ghostty.app" ]; then
  echo "Installing Ghostty..."
  brew install --cask ghostty
fi

# GitHub CLI 설치 (git 인증, PR 관리)
if ! command -v gh &> /dev/null; then
  echo "Installing GitHub CLI..."
  brew install gh
fi

# tmux 설치 (Claude Code Agent Teams split pane)
if ! command -v tmux &> /dev/null; then
  echo "Installing tmux..."
  brew install tmux
fi

# Claude Code 설치 (native)
if ! command -v claude &> /dev/null; then
  echo "Installing Claude Code (native)..."
  curl -fsSL https://claude.ai/install.sh | sh
fi

# terminal-notifier 설치 (Claude Code 알림용)
if ! command -v terminal-notifier &> /dev/null; then
  echo "Installing terminal-notifier for Claude Code notifications..."
  brew install terminal-notifier
fi

# zshrc 파일 업데이트 후 적용
source ~/.zshrc
